{"version":3,"file":"app.min.js","sources":["../src/config.js","../src/index.mjs"],"sourcesContent":["/**\n * @file index.js\n * @author Dino <dinoabsoluto+dev@gmail.com>\n * @license\n * This file is part of translator-js.\n *\n * translator-js is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * translator-js is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with translator-js.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n/* config */\nconst config = {\n  version: require('../package.json').version,\n  sourceDir: __dirname\n}\n\nmodule.exports = config\n","/**\n * @file index.mjs\n * @author Dino <dinoabsoluto+dev@gmail.com>\n * @license\n * This file is part of translator-js.\n *\n * translator-js is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * translator-js is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with translator-js.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n/* imports */\nimport chalk from 'chalk'\nimport info from './config.js'\nimport yargs from 'yargs'\nimport path from 'path'\n/* -imports */\n\nconst report = (error) => {\n  console.error(chalk`{red ${report.stack ? error.stack : error}}`)\n  if (report.pedantic) {\n    process.exit(-1)\n  }\n}\nreport.pedantic = true\n\nconst _postParse = (config) => {\n  report.stack = !!config.stack\n  report.pedantic = !!config.pedantic\n}\n\nconst _glob = async (config) => {\n  const globby = await import('globby')\n  if (config.sources && config.sources.length) {\n    return\n  }\n  let indexes = await globby(path.join(config.output, '*/index.json'))\n  config.sources = indexes.map(fpath => path.dirname(fpath))\n}\n\nconst _get = async (config) => {\n  const getEngine = (await import('./get')).default\n  let output = config.output || './download/'\n  for (const source of config.sources) {\n    try {\n      let engine = await getEngine({\n        source,\n        verbose: true,\n        chdir: output,\n        overwrite: config.force\n      })\n      await engine.refresh()\n    } catch (error) {\n      report(error)\n    }\n  }\n}\n\nconst cmdGet = async (config) => {\n  await _postParse(config)\n  await _glob(config)\n  await _get(config)\n}\n\nconst _parseArgs = async () => {\n  return yargs.strict(true)\n    .usage('$0 get [--output=<path>] [options] [<URL> | <path>..]')\n    .help('help').alias('help', 'h')\n    .version(info.version)\n    .group([ 'help', 'version' ], 'Info:')\n    .option('stack', {\n      hidden: true,\n      default: false,\n      type: 'boolean'\n    })\n    .option('output', {\n      alias: ['o'],\n      default: 'download',\n      type: 'string',\n      desc: 'Output directory'\n    })\n    .option('force', {\n      alias: ['f'],\n      default: false,\n      type: 'boolean',\n      desc: 'Overwrite untracked files'\n    })\n    .option('pedantic', {\n      default: true,\n      type: 'boolean',\n      desc: 'Exit on first error'\n    })\n    .command(\n      'get [<sources>..]',\n      'Get RAWs',\n      yargs => yargs.strict()\n        .usage('$0 get [--output=<path>] [options] [<URL> | <path>..]')\n        .argv,\n      cmdGet\n    )\n    .demandCommand(1)\n    .fail(err => {\n      yargs.showHelp()\n      report(err)\n    })\n    .argv\n}\n\n/**\n * Main function\n */\nconst _main = async () => {\n  await _parseArgs()\n}\n\n_main().catch(report)\n"],"names":["config","version","require$$0","sourceDir","__dirname","report","error","console","chalk","stack","pedantic","process","exit","_postParse","_glob","async","globby","Promise","sources","length","indexes","path","join","output","map","fpath","dirname","_get","getEngine","default","source","engine","verbose","chdir","overwrite","force","refresh","cmdGet","_parseArgs","yargs","strict","usage","help","alias","info","group","option","hidden","type","desc","command","argv","demandCommand","fail","err","showHelp","_main","catch"],"mappings":"4hFAqBA,MAAMA,OAAS,CACbC,QAASC,WAA2BD,QACpCE,UAAWC,WAGb,aAAiBJ,OCCjB,MAAMK,OAAUC,IACdC,QAAQD,MAAME,aAAaH,OAAOI,MAAQH,EAAMG,MAAQH,MACpDD,OAAOK,UACTC,QAAQC,MAAM,IAGlBP,OAAOK,UAAW,EAElB,MAAMG,WAAcb,IAClBK,OAAOI,QAAUT,EAAOS,MACxBJ,OAAOK,WAAaV,EAAOU,UAGvBI,MAAQC,MAAAA,UACNC,QAAeC,wBAAO,cACxBjB,EAAOkB,SAAWlB,EAAOkB,QAAQC,kBAGjCC,QAAgBJ,EAAOK,KAAKC,KAAKtB,EAAOuB,OAAQ,iBACpDvB,EAAOkB,QAAUE,EAAQI,IAAIC,GAASJ,KAAKK,QAAQD,KAG/CE,KAAOZ,MAAAA,UACLa,SAAmBX,wBAAO,mBAAUY,YACtCN,EAASvB,EAAOuB,QAAU,kBACzB,MAAMO,KAAU9B,EAAOkB,gBAEpBa,QAAeH,EAAU,CAC3BE,OAAAA,EACAE,SAAS,EACTC,MAAOV,EACPW,UAAWlC,EAAOmC,cAEdJ,EAAOK,UACb,MAAO9B,GACPD,OAAOC,KAKP+B,OAAStB,MAAAA,UACPF,WAAWb,SACXc,MAAMd,SACN2B,KAAK3B,IAGPsC,WAAavB,SACVwB,MAAMC,QAAO,GACjBC,MAAM,yDACNC,KAAK,QAAQC,MAAM,OAAQ,KAC3B1C,QAAQ2C,SAAK3C,SACb4C,MAAM,CAAE,OAAQ,WAAa,SAC7BC,OAAO,QAAS,CACfC,QAAQ,EACRlB,SAAS,EACTmB,KAAM,YAEPF,OAAO,SAAU,CAChBH,MAAO,CAAC,KACRd,QAAS,WACTmB,KAAM,SACNC,KAAM,qBAEPH,OAAO,QAAS,CACfH,MAAO,CAAC,KACRd,SAAS,EACTmB,KAAM,UACNC,KAAM,8BAEPH,OAAO,WAAY,CAClBjB,SAAS,EACTmB,KAAM,UACNC,KAAM,wBAEPC,QACC,oBACA,WACAX,GAASA,EAAMC,SACZC,MAAM,yDACNU,KACHd,QAEDe,cAAc,GACdC,KAAKC,IACJf,MAAMgB,WACNlD,OAAOiD,KAERH,KAMCK,MAAQzC,gBACNuB,cAGRkB,QAAQC,MAAMpD"}